---
Date: 2024-05-28T09:11:00
Summary: CMD & Powershell
---

# Windows Command Line
---
#HTB #prerequisites #CDSA #windows #windows_terminal

Table of contents >>> [[Hack The Box]]

# Introduction
---

There are two main built-in tools in windows and these are CMD and PowerShell.
- You can run CMD commands on PowerShell
- You can run PowerShell commands on CMD but you have to preface the command with PowerShell get-alias

| **PowerShell**                                                             | *Command Prompt*                                      |
| -------------------------------------------------------------------------- | ----------------------------------------------------- |
| Introduced in 2006                                                         | Introduced in 1981                                    |
| Can run both batch commands and PowerShell cmdlets                         | Can only run batch commands                           |
| Supports the use of command aliases                                        | Does not support command aliases                      |
| Cmdlet output can be passed to other cmdlets                               | Command output cannot be passed to other commands     |
| All output is in the form of an object                                     | Output of commands is text                            |
| Able to execute a sequence of cmdlets in a script                          | A command must finish before the next command can run |
| Has an Integrated Scripting Environment (ISE)                              | Does not have an ISE                                  |
| Can access programming libraries because it is built on the .NET framework | Cannot access these libraries                         |
| Can be run on Linux systems                                                | Can only be run on Windows systems                    |
# Command Prompt Basics
---
CMD allows to input commands that are directly interpreted and the executed by the OS. A single command can change user's password or check the status of NICs.

Local Access:
- Using the Windows key + `r` to bring up the run prompt, and then typing in `cmd`. OR
- Accessing the executable from the drive path `C:\Windows\System32\cmd.exe`.

Remote Access:
- Secure Shell (`SSH`), `PsExec`, `WinRM`, `RDP`, or other protocols as needed

# Getting Help
---
```cmd-session
help time
```

Some commands use `/?` instead of help command #command 

```cmd
ipconfig /?
```

Cheat Sheet - [ss64](https://ss64.com/nt/)

#### Command history
To display commands history: #command 
```cmd-session
donkey /history
```
`Donkey` is an MS-DOS utility that keeps a history of commands issued and allows them to be referenced again.

| **Key/Command** | **Description**                                                                                                            |
| :-------------: | -------------------------------------------------------------------------------------------------------------------------- |
| doskey /history | doskey /history will print the session's command history to the terminal or output it to a file when specified.            |
|     page up     | Places the first command in our session history to the prompt.                                                             |
|    page down    | Places the last command in history to the prompt.                                                                          |
|        ⇧        | Allows us to scroll up through our command history to view previously run commands.                                        |
|        ⇩        | Allows us to scroll down to our most recent commands run.                                                                  |
|        ⇨        | Types the previous command to prompt one character at a time.                                                              |
|        ⇦        | N/A                                                                                                                        |
|       F3        | Will retype the entire previous entry to our prompt.                                                                       |
|       F5        | Pressing F5 multiple times will allow you to cycle through previous commands.                                              |
|       F7        | Opens an interactive list of previous commands.                                                                            |
|       F9        | Enters a command to our prompt based on the number specified. The number corresponds to the commands place in our history. |
`ctrl+c` is how we interrupt a program effectively killing it


# System Navigation
---
List Directories #command 
```cmd-session
dir
```

Change directory #command 
```cmd-session
cd 
```

There is difference between absolute path and relative:
```cmd-session
cd C:\Users\htb\Pictures	                    and/or        

cd .\Pictures
```

To list all folder and files #command 
```cmd-session
tree /F
```
#### Interesting Directories
| Name:               | Location:                            | Description:                                                                                                                                                                                                                                                                     |
| ------------------- | ------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| %SYSTEMROOT%\Temp   | `C:\Windows\Temp`                    | Global directory containing temporary system files accessible to all users on the system. All users, regardless of authority, are provided full read, write, and execute permissions in this directory. Useful for dropping files as a low-privilege user on the system.         |
| %TEMP%              | `C:\Users\<user>\AppData\Local\Temp` | Local directory containing a user's temporary files accessible only to the user account that it is attached to. Provides full ownership to the user that owns this folder. Useful when the attacker gains control of a local/domain joined user account.                         |
| %PUBLIC%            | `C:\Users\Public`                    | Publicly accessible directory allowing any interactive logon account full access to read, write, modify, execute, etc., files and subfolders within the directory. Alternative to the global Windows Temp Directory as it's less likely to be monitored for suspicious activity. |
| %ProgramFiles%      | `C:\Program Files`                   | folder containing all 64-bit applications installed on the system. Useful for seeing what kind of applications are installed on the target system.                                                                                                                               |
| %ProgramFiles(x86)% | `C:\Program Files (x86)`             | Folder containing all 32-bit applications installed on the system. Useful for seeing what kind of applications are installed on the target system.                                                                                                                               |
# Working with Directories and Files
---
How to create new directory #command 
```cmd-session
md new-directory
```
How to remove directory #command 
```cmd-session
rd new-directory

rd /S new-directory
```


