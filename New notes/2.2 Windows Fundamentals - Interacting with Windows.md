---
Date: 2024-01-13T18:12:00
Summary:
---
# Windows basics
---

#htb #windows 
Table of contents >>> [[Hack The Box]]
Previous page >>> [[2.1 Windows Fundamentals - Core of the Operating System]]

# Interaction with Windows
---

## Windows Sessions
- **Interactive** - Local logon session initiated by a used authenticating to a local or domain system by entering their credentials. An interactive logon can be initiated by logging directly into the system.
- **Non-interactive** - they do not require login credentials. There are 3 types: Local System Account. Local Service Account, Network Service Account. These are used by Windows to automatically start services because each service needs a "user" to start them.

| Account | Description |
| ---- | ---- |
| Local System Account | Also known as the `NT AUTHORITY\SYSTEM` account, this is the most powerful account in Windows systems. It is used for a variety of OS-related tasks, such as starting Windows services. This account is more powerful than accounts in the local administrators group. |
| Local Service Account | Known as the `NT AUTHORITY\LocalService` account, this is a less privileged version of the SYSTEM account and has similar privileges to a local user account. It is granted limited functionality and can start some services. |
| Network Service Account | This is known as the `NT AUTHORITY\NetworkService` account and is similar to a standard domain user account. It has similar privileges to the Local Service Account on the local machine. It can establish authenticated sessions for certain network services. |

# Interacting with the Windows Operating System
---

## Graphical User Interface
An interface that allows casual users use the PC without touching command line. It is used by the administrators to ease their work conditions.

## Remote Desktop Protocol (RDP)
It's a Microsoft #protocol which allows user to connect to remote system over the network. RDP uses port 3389 which sends data back and forth. Unlike SSH user is able to access GUI applications alongside the command line applications. It can be also used to access local network via virtual private network (VPN).

## Windows Command Line
Greater control over the system including admin and troubleshooting tasks. It can also be used for automation and writing scripts.

## CMD
Command Prompt is used to enter and execute commands such as ipconfig, schedule tasks or create scripts and batch files.

**How to show more detailed help** #command 
```cmd-session
ipconfig /?
```
## PowerShell
It was created mostly for system administrators. PowerShell is built on top of the .NET Framework which is used for building and running applications on Windows. Like the command prompt, PowerShell gives us direct access to the file system, and we run the majority of the same commands that we can within a cmd shell.

## Cmdlets
PowerShell is using cmdlets which are small single function tools built into the shell. Bascially it's the commands such as `cd` and `ls`. Cmdlets are in the form **Verb-Noun**. `Get-ChildItem` is used to list current directory. `Get-ChildItem -Recurse` similar to tree.

**Display directories** #command 
```Shell
Get-ChildItem
Get-ChildItem -Recurse
Get-ChildItem -Path C:\Users\Administrator\Documents
Get-ChildItem -Path C:\Users\Administrator\Downloads -Recurse
```

## Aliases
Many cmdlets have aliases such `Set-location = cd, Get-ChildItem = ls `

**Display aliases** #command 
```powershell-session
get-alias
```

**CreateNew-Alias** #command 
```powershell-session
New-Alias -Name "Show-Files" Get-ChildItem
```

**Open Online help** #command 
```
Get-Help <cmdlet-name> -Online
```

**Installing help package** #command 
```powershell-session
Get-Help Get-AppPackage
```

# Running Scripts

PowerShell ISE (Integrated Scripting Environment) allows us to write scripts on the fly. It has autocomplete/lookup function for PowerShell commands. Scrips can be written in the same console, useful for quick debugging.

**Loading into memory with a download cradle** #command 
```powershell-session
 .\PowerView.ps1;Get-LocalGroup |fl
```
1. `.\PowerView.ps1`: This portion of the command is attempting to execute the PowerView PowerShell script. The `.\` indicates that the script is in the current directory.
    
2. `Get-LocalGroup`: This is a PowerShell cmdlet that is part of PowerView. It is used to retrieve information about local groups on a Windows system. In this context, it's likely being used to enumerate the local groups on the target system.
    
3. `|fl`: This is a pipeline operator in PowerShell. It takes the output from the previous command (`Get-LocalGroup`) and sends it as input to the next command (`fl`). `fl` is an alias for the `Format-List` cmdlet, which formats the output as a list. This is used to display the information in a more detailed format.